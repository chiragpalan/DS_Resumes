
Sub Process_XLSX_Files_And_UnmergeFill()
    Dim folderPath As String, fileName As String
    Dim wb As Workbook
    Dim wsSource As Worksheet, wsDest As Worksheet
    Dim cell As Range, mergeArea As Range
    Dim val As Variant
    Dim c As Range

    ' üîÅ Set your folder path here
    folderPath = "C:\Your\Path\abcd\"

    If Right(folderPath, 1) <> "\" Then folderPath = folderPath & "\"
    fileName = Dir(folderPath & "*.xlsx")

    Application.ScreenUpdating = False
    Application.DisplayAlerts = False

    Do While fileName <> ""
        Set wb = Workbooks.Open(folderPath & fileName)

        On Error Resume Next
        Set wsSource = wb.Sheets("NEW")
        On Error GoTo 0

        If Not wsSource Is Nothing Then
            ' Delete Sheet2 if it already exists
            On Error Resume Next
            wb.Sheets("Sheet2").Delete
            On Error GoTo 0

            ' Add new Sheet2
            Set wsDest = wb.Sheets.Add(After:=wb.Sheets(wb.Sheets.Count))
            wsDest.Name = "Sheet2"

            ' Copy data from NEW!B11:R18 ‚Üí Sheet2!A1:Q8
            wsDest.Range("A1:Q8").Value = wsSource.Range("B11:R18").Value

            ' ‚úÖ Unmerge all merged cells and fill each resulting cell with original value
            For Each cell In wsDest.UsedRange
                If cell.MergeCells Then
                    Set mergeArea = cell.MergeArea
                    val = cell.Value
                    mergeArea.UnMerge
                    For Each c In mergeArea.Cells
                        c.Value = val
                    Next c
                End If
            Next cell

            wb.Save
            wb.Close
        Else
            MsgBox "‚ùå Sheet 'NEW' not found in: " & fileName, vbExclamation
            wb.Close False
        End If

        fileName = Dir
    Loop

    Application.ScreenUpdating = True
    Application.DisplayAlerts = True

    MsgBox "‚úÖ All .xlsx files in 'abcd' folder processed!"
End Sub
